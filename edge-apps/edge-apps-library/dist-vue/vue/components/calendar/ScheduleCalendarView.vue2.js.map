{"version":3,"file":"ScheduleCalendarView.vue2.js","sources":["../../../../src/vue/components/calendar/ScheduleCalendarView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, watch, computed } from 'vue'\nimport EventTimeRange from './EventTimeRange.vue'\nimport type { CalendarEvent } from '../../constants/calendar'\nimport dayjs from 'dayjs'\nimport utc from 'dayjs/plugin/utc'\nimport dayJsTimezone from 'dayjs/plugin/timezone'\n\ndayjs.extend(utc)\ndayjs.extend(dayJsTimezone)\n\nconst MAX_EVENTS = 7\n\ninterface Props {\n  timezone?: string\n  now: Date\n  events: CalendarEvent[]\n  locale: string\n  currentDayOfWeek: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  timezone: 'UTC',\n})\n\nconst todayEvents = ref<CalendarEvent[]>([])\nconst tomorrowEvents = ref<CalendarEvent[]>([])\n\nconst currentDayOfWeek = computed(() => props.currentDayOfWeek)\nconst events = computed(() => props.events)\n\nconst filterAndFormatEvents = () => {\n  // Get current time in the target timezone\n  const nowInTimezone = dayjs().tz(props.timezone)\n  const todayInTimezone = nowInTimezone.startOf('day')\n  const tomorrowInTimezone = todayInTimezone.add(1, 'day')\n\n  // Filter today's events (from now until end of today)\n  const todayEventsList = events.value.filter((event: CalendarEvent) => {\n    const eventStart = dayjs(event.startTime).tz(props.timezone)\n    return (\n      eventStart.isAfter(nowInTimezone) &&\n      eventStart.isBefore(tomorrowInTimezone)\n    )\n  })\n\n  // Filter tomorrow's events (full day tomorrow)\n  const dayAfterTomorrow = tomorrowInTimezone.add(1, 'day')\n  const tomorrowEventsList = events.value.filter((event: CalendarEvent) => {\n    const eventStart = dayjs(event.startTime).tz(props.timezone)\n    return (\n      eventStart.isAfter(tomorrowInTimezone) &&\n      eventStart.isBefore(dayAfterTomorrow)\n    )\n  })\n\n  // Sort events by start time\n  const sortByStartTime = (a: CalendarEvent, b: CalendarEvent) => {\n    return (\n      dayjs(a.startTime).tz(props.timezone).valueOf() -\n      dayjs(b.startTime).tz(props.timezone).valueOf()\n    )\n  }\n\n  todayEventsList.sort(sortByStartTime)\n  tomorrowEventsList.sort(sortByStartTime)\n\n  // Distribute events to maintain total around MAX_EVENTS\n  let limitedTodayEvents: CalendarEvent[]\n  let limitedTomorrowEvents: CalendarEvent[]\n\n  if (todayEventsList.length >= MAX_EVENTS) {\n    // If today has 7+ events, show only today's events\n    limitedTodayEvents = todayEventsList.slice(0, MAX_EVENTS)\n    limitedTomorrowEvents = []\n  } else {\n    // Show all of today's events and fill remaining slots with tomorrow's events\n    limitedTodayEvents = todayEventsList\n    const remainingSlots = MAX_EVENTS - todayEventsList.length\n    limitedTomorrowEvents = tomorrowEventsList.slice(0, remainingSlots)\n  }\n\n  todayEvents.value = limitedTodayEvents\n  tomorrowEvents.value = limitedTomorrowEvents\n}\n\nwatch([events, () => props.timezone], filterAndFormatEvents, {\n  immediate: true,\n})\n</script>\n\n<template>\n  <div class=\"ScheduleCalendarView primary-card\">\n    <div class=\"schedule-day-section\">\n      <h2 class=\"day-header\">{{ currentDayOfWeek }}</h2>\n      <div class=\"events-list\">\n        <div\n          v-for=\"(event, index) in todayEvents\"\n          :key=\"index\"\n          class=\"schedule-event-block\"\n          :style=\"\n            event.backgroundColor\n              ? { backgroundColor: event.backgroundColor }\n              : {}\n          \"\n        >\n          <div class=\"event-title\">{{ event.title }}</div>\n          <EventTimeRange\n            :start-time=\"event.startTime\"\n            :end-time=\"event.endTime\"\n            :locale=\"props.locale\"\n            :timezone=\"props.timezone\"\n          />\n        </div>\n        <div v-if=\"todayEvents.length === 0\" class=\"no-events\">\n          No events scheduled for today\n        </div>\n      </div>\n    </div>\n\n    <div v-if=\"tomorrowEvents.length > 0\" class=\"schedule-day-section\">\n      <h2 class=\"day-header\">TOMORROW</h2>\n      <div class=\"events-list\">\n        <div\n          v-for=\"(event, index) in tomorrowEvents\"\n          :key=\"index\"\n          class=\"schedule-event-block\"\n          :style=\"\n            event.backgroundColor\n              ? { backgroundColor: event.backgroundColor }\n              : {}\n          \"\n        >\n          <div class=\"event-title\">{{ event.title }}</div>\n          <EventTimeRange\n            :start-time=\"event.startTime\"\n            :end-time=\"event.endTime\"\n            :locale=\"props.locale\"\n            :timezone=\"props.timezone\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n@use '../../styles/calendar/schedule-calendar-view';\n</style>\n"],"names":["MAX_EVENTS","dayjs","utc","dayJsTimezone","props","__props","todayEvents","ref","tomorrowEvents","currentDayOfWeek","computed","events","watch","nowInTimezone","tomorrowInTimezone","todayEventsList","event","eventStart","dayAfterTomorrow","tomorrowEventsList","sortByStartTime","a","b","limitedTodayEvents","limitedTomorrowEvents","remainingSlots","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_hoisted_4","_Fragment","_renderList","index","_normalizeStyle","_hoisted_5","_createVNode","EventTimeRange","_hoisted_6","_hoisted_7","_cache","_hoisted_8","_hoisted_9"],"mappings":"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"}